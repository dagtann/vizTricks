---
title: "Multiplicative Interaction Terms with continuous Predictors"
author: dagtann
data: "November 20, 2015"
output: html_document
---


[Government duration data](http://www.press.umich.edu/resources/govduration.dta)

```{r, fig.align='center'}
# load data ------------------------------------------------
rm(list = ls())
dta <- data.frame(
  id = c(
    2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
    17, 18, 19, 20, 21, 22, 23
  ),
  govdur = c(
    17.1, 32.2, 11.9, 12.3, 32.8, 30.0, 30.8, 18.0,
    20.2, 13.6, 11.0, 26.6, 31.8, 45.1, 30.3, 25.2, 11.5,
    29.2, 24.7, 43.6, 22.4, 30.4
  ),
  PS = c(
    52.0, 58.9, 59.0, 52.1, 54.3, 55.0, 76.4, 61.7,
    41.1, 57.4, 63.3, 55.4, 50.9, 69.3, 62.0, 47.6, 60.0,
    50.5, 47.2, 80.4, 59.1, 57.2
  ),
  NP = c(
    1.0, 2.2, 4.3, 2.7, 1.0, 1.0, 1.8, 3.0, 1.8, 2.9,
    1.1, 2.2, 1.6, 2.0, 3.3, 1.8, 1.6, 1.0, 1.4, 3.8, 1.7,
    1.0
  ),
  PD = c(
    0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0,
    0, 1, 1, 1, 1
  )
)
head(dta)

# fit model & generate predictions ------------------------
fit <- lm(govdur ~ NP*PS + PD, data = dta)
summary(fit)

quantiles <- c(.05, .25, .5, .75, .95)
pred.dta <- expand.grid(
  # expand.grid covers all quantile combinations
  NP = quantile(dta[, 'NP'], quantiles),
  PS = quantile(dta[, 'PS'], quantiles),
  PD = mean(dta[, 'PD'])
)
pred.y <- predict(
  fit, newdata = pred.dta, type = 'response',
  se.fit = TRUE, interval = 'confidence'
)
pdta <- data.frame(
  pred.dta, pred.y[['fit']], se.fit = pred.y[['se.fit']]
)
rm(quantiles, pred.y)

# simple map ----------------------------------------------
library('ggplot2')
ggplot(data = pdta,
  aes(
    x = factor(format(NP, digits = 2)),
    y = factor(format(PS, digits = 3)),
    fill = fit
  )
) +
  geom_tile(colour = 'white', size = .8) +
  scale_fill_gradient(
    low = '#7f0000', high = '#fff7ec', limits = c(0, 40),
    breaks = seq(0, 40, 10)
  ) +
  labs(x = 'Number of Cabinet Parties', y = 'Political Strength', 
    fill = 'Fitted Government Duration'
  ) +
  theme_minimal() +
  theme(
    text = element_text(family = 'serif'),
    legend.position = 'top', legend.direction = 'horizontal',
    panel.grid = element_blank(), plot.background = element_blank()
  )
```
